<button type="button" (click)="toggleCombine()">combine</button>
<button
  type="button"
  (click)="toggleBold()"
  [ngStyle]="{ 'font-weight': activeCell?.style.fontWeight || 'normal' }"
>
  bold
</button>
<div class="panel panel-wrapper">
  <canvas
    tabindex="0"
    autofocus
    #panel
    class="panel"
    (mouseover)="onMouseOver($event)"
    (mouseout)="onMouseOut($event)"
    (mouseenter)="onMouseEnter($event)"
    (mouseLeave)="onMouseLeave($event)"
    (mousedown)="onMouseDown($event)"
    (mousemove)="onMouseMove($event)"
    (mouseup)="onMouseUp($event)"
    (wheel)="onWheel($event)"
    (contextmenu)="onContextMenu($event)"
    (keydown)="onKeyDown($event)"
    (keypress)="onKeyPress($event)"
  ></canvas>
  <canvas #actionPanel class="action-panel"></canvas>
  <canvas #animationPanel class="action-panel"></canvas>
  <ng-container *ngIf="this.state.isCellEdit">
    <div
      class="mask"
      [ngStyle]="{
        'left.px': offsetLeft,
        'top.px': offsetTop,
        'right.px': scrollBarWidth,
        'bottom.px': scrollBarWidth
      }"
    >
      <div class="mask-content">
        <input
          appAutoFocus
          name="editCell"
          type="text"
          class="editCell"
          autocomplete="off"
          [ngStyle]="{
            'left.px': editingCell?.x - scrollLeft - offsetLeft + 1,
            'top.px': editingCell?.y - scrollTop - offsetTop + 1,
            'width.px': editingCell?.width - 2,
            'height.px': editingCell?.height - 2
          }"
          [(ngModel)]="editingCell?.content.value"
          (keydown)="onEditCellKeyDown($event)"
        />
      </div>
    </div>
  </ng-container>
</div>
